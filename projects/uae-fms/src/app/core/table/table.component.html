<div class="app-table-wrapper">
  <p-table [value]="setting.data" (mouseleave)='rowIndexTable= -1' (sortFunction)="handleSort($event, setting)"
    [customSort]='true'>
    <ng-template pTemplate="header">
      <tr>
        <th style="height:100% ; width: 1px" class="p-0 m-0"></th>
        <th *ngFor="let col of setting.columns" [style]="col.width &&
          isNumber(col.width) ? 'width:'+col.width+'px' :'width:'+col.width" [pSortableColumn]='col.field'
          [pSortableColumnDisabled]='!col.sortable'>
          <div class="d-flex">
            <ng-template [ngIf]="col.sortable">
              <img [class.sort]='col.isAsc === false' class="icon-dorp" src="assets/icons/sort-down-solid.svg" alt="">
            </ng-template>
            <ng-template [ngIf]="!col.isIconLable" [ngIfElse]="iconType">
              <p class="m-0 p-0" pTooltip='{{col.lable | translate}}' tooltipPosition='bottom' title=''>{{col.lable|translate}}</p>
            </ng-template>
            <ng-template #iconType>
              <div class="iconLable" [innerHTML]="col.lable"></div>
            </ng-template>
          </div>
        </th>
        <th *ngIf="foundStatusColor(setting.data)" style="width:0px;"></th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-data let-i="rowIndex">
      <tr (mouseover)='rowIsHover(i)' [class]="'tableRow'+(setting.rowSettings?.onClick?' clickable':'')"
        [ngStyle]="{'background': isSelected(i) ? data.statusColor : null }">
        <span style="height:100% ; width: 5px; position: relative;display: table-cell;">
          <div class="statusColor with-renderer-table" *ngIf="data.statusColor"
            [style]="'background:'+data.statusColor+';'"></div>
        </span>
        <td [ngStyle]="{'background': isSelected(i) ? 'transparent' : null }" *ngFor="let col of setting.columns"
          (click)="click(col,data)" [attr.style]="col.textColor?'color:'+col.textColor+';':''">
          <div *ngIf="!col.renderer">
            <div class="d-flex">
              <span class="p-column-title">{{col.lable}}</span>
              <span [innerHTML]="this.getCol(col,data)" class="column-data">
                <!-- {{ this.getCol(col,data) }} -->
              </span>
            </div>
          </div>
          <div *ngIf="col.renderer=='userRenderer'">
            <table-user-renderer [user]="data"></table-user-renderer>
          </div>
          <div *ngIf="col.renderer=='vehicleRenderer'">
            <table-vehicle-renderer [vehicle]="data[col.field]"></table-vehicle-renderer>
          </div>
          <div *ngIf="col.renderer=='assetRenderer'">
            <table-asset-renderer [asset]="data"></table-asset-renderer>
          </div>
          <div *ngIf="col.renderer=='doubleLineRenderer'">
            <table-double-line-renderer [user]="data" [column]="col"></table-double-line-renderer>
          </div>
          <div *ngIf="showButton(col,i)">
            <table-general-button-renderer [setting]="setting.rowSettings" [row]="data[i]" [button]="data" [col]="col">
            </table-general-button-renderer>
          </div>
          <div *ngIf="col.renderer == 'subtextRenderer'">
            <table-subText-renderer [data]="data[col.field]"></table-subText-renderer>
          </div>
          <div *ngIf="col.renderer == 'informationRenderer'">
            <table-information-renderer [data]="data[col.field]"></table-information-renderer>
          </div>
          <div *ngIf="col.renderer == 'statusRenderer'">
            <table-status-renderer [status]="data"></table-status-renderer>
          </div>
          <div *ngIf="col.renderer == 'thumbTextRenderer'">
            <table-thumb-text-renderer [data]="data"></table-thumb-text-renderer>
          </div>
          <div *ngIf="col.renderer == 'booleanRenderer'">
            <table-boolean-renderer [setting]="setting.rowSettings" (selectTR)="selectTR($event)" [allData]="data"
              [data]="data[col.field]" [indexTR]="i" [hover]="rowIndexTable"></table-boolean-renderer>
          </div>
          <div *ngIf="col.renderer == 'externalLinkRenderer'">
            <table-external-link-renderer [link]="data[col.field]"></table-external-link-renderer>
          </div>
          <div *ngIf="col.renderer == 'routeLinkRenderer' && i == rowIndexTable">
            <table-route-link-renderer [link]="data['id']"></table-route-link-renderer>
          </div>
          <div *ngIf="col.renderer=='assetsRenderer'">
            <table-assets-renderer [data]="data[col.field]"></table-assets-renderer>
          </div>
          <div *ngIf="col.renderer=='fuelCardRenderer'">
            <fuel-card-renderer [data]="data[col.field]"></fuel-card-renderer>
          </div>
          <div *ngIf="col.renderer=='companyRenderer'">
            <table-company-renderer [company]="data"></table-company-renderer>
          </div>
          <div *ngIf="col.renderer=='assignNow'">
            <table-assign-now-renderer [data]="data"></table-assign-now-renderer>
          </div>
          <div *ngIf="col.renderer=='floatButton' && i == rowIndexTable">
            <float-button-renderer [lang]="activeLang" [col]="col" [setting]="setting.rowSettings" [data]="data">
            </float-button-renderer>
          </div>
          <div *ngIf="col.renderer=='colorize'">
            <table-colorize-renderer [lang]="activeLang" [data]="data[col.field]" [options]="col.rendererOptions">
            </table-colorize-renderer>
          </div>
          <div *ngIf="col.renderer=='trimColorRenderer'">
            <table-trim-color-renderer [colors]="data[col.field]"></table-trim-color-renderer>
          </div>
          <div *ngIf="col.renderer=='checkboxRenderer'">
            <table-checkbox-renderer (onChange)="updatedSelectedIds($event,col.field)" [data]='data' [field]="col.field"></table-checkbox-renderer>
            <!-- <table-checkbox-renderer (onChange)="updatedSelectedIds($event)" [data]='data[col.field]'></table-checkbox-renderer> -->
          </div>
          <div *ngIf="col.renderer=='downloadButtonRenderer'">
            <table-download-button-renderer [link]='data[col.field]'></table-download-button-renderer>
          </div>
          <div *ngIf="col.renderer=='downloadButtonRenderer'">
            <table-download-button-renderer [link]='data[col.field]'></table-download-button-renderer>
          </div>

        </td>
        <div [class]="'statusColor'+ (hasRendere(setting.columns)?'with-renderer-table':' simple-table')"
          *ngIf="data.statusColor" [style]="'background:'+data.statusColor+';'"></div>
      </tr>
    </ng-template>

  </p-table>
</div>
